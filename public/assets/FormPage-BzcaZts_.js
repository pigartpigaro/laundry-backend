const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ListRinci-CJmKeY9P.js","assets/index-C65Hd5S6.js","assets/index-d_wRuNXg.css","assets/QItem-BmvTbfCZ.js","assets/QList-573_Wy6u.js","assets/notifs-C5sbblO4.js","assets/formatter-BUPKQdZl.js","assets/QForm-DoygxfT4.js","assets/list-CF7jxGWo.js","assets/DialogRinci-DR8ISafN.js","assets/QSpace-CMevY34W.js"])))=>i.map(i=>d[i]);
import{aW as R,ac as v,c as F,b8 as O,o as T,W as g,a4 as E,Y as k,$ as c,f as d,Z as h,aX as Q,a2 as o,X as A,a5 as H,aT as N,k as y,aY as x,F as B,_ as V}from"./index-C65Hd5S6.js";import{Q as U}from"./QForm-DoygxfT4.js";import{n as q,a as $,u as I}from"./notifs-C5sbblO4.js";import{u as L}from"./list-CF7jxGWo.js";const M=R("form-order-transaksi-store",{state:()=>({form:{id:null,no_nota:null,kodepelanggan:null,pelanggan:null,alamat:null,nohp:null,rincians:[]},dialogCetak:!1,dialogrincis:!1,loading:!1,disableHeader:!1,activeRinciIndex:null,dataCetak:[]}),actions:{initReset(l){if(console.log("Data dari backend:",l),l)return new Promise(t=>{for(const n in this.form)n!=="rincians"&&(this.form[n]=l[n]||null);this.form.rincians=l.rincians?[...l.rincians]:[],console.log("Data rincians setelah diisi:",this.form.rincians),t()});for(const t in this.form)t!=="rincians"&&(this.form[t]=null);this.form.rincians=[]},async save(l){this.loading=!0;const t=new FormData;for(const n in this.form)n!=="rincians"&&this.form[n]!==null&&t.append(n,this.form[n]);return this.form.rincians&&this.form.rincians.length>0&&t.append("rincians",JSON.stringify(this.form.rincians)),new Promise((n,u)=>{v.post("/xy/order/transaksi/saveorder",this.form).then(({data:a})=>{var s;console.log("saved",a),this.loading=!1;const i=L();l?i!=null&&i.items&&((s=a==null?void 0:a.result)!=null&&s.id)&&(i.items=i.items.map(r=>(r==null?void 0:r.id)===a.result.id?{...r,...a.result}:r)):i.items.unshift(a==null?void 0:a.result),q("Data berhasil disimpan"),this.form={...this.form,...a.result},n(a)}).catch(a=>{this.loading=!1,u(a)})})},async deleteData(l){var n;console.log("id",l);const t={id:l};try{if((await v.post("/xy/order/transaksi/deleteorder",t)).status===200){const a=(n=this.form.rincians)==null?void 0:n.filter(i=>(i==null?void 0:i.id)!==l);this.form.rincians=a,q("Data berhasil dihapus")}}catch(u){console.log("Gagal menghapus gambar:",u),$("Terjadi Kesalahan")}}}}),W={class:"fit column"},X={class:"col-auto"},Y={class:"row items-center q-pa-lg"},z={class:"col-grow"},G={class:"col full-height q-px-lg q-pb-lg"},J={class:"row q-col-gutter-md justify-around"},K={class:"row q-col-gutter-md"},Z={class:"col-12"},j={class:"col full-height q-px-lg q-pb-lg"},ee={__name:"FormPage",props:{data:{type:Object,default:null}},emits:["back"],setup(l,{emit:t}){const n=y(()=>V(()=>import("./ListRinci-CJmKeY9P.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),u=y(()=>V(()=>import("./DialogRinci-DR8ISafN.js"),__vite__mapDeps([9,10,1,2,7,5,8]))),a=t,i=I();F(()=>i.screen.lt.sm);const s=M(),r=O(),P=l;T(()=>{s.initReset(P.data)});function S(_){const e=r==null?void 0:r.items.find(p=>(p==null?void 0:p.pelanggan)===_);s.form.kodepelanggan=e==null?void 0:e.kodepelanggan,s.form.alamat=e==null?void 0:e.alamat,s.form.nohp=e==null?void 0:e.nohp,s.dialogrincis=!0,console.log("form",s.dialogrincis)}function w(){s.dialogrincis=!0}return(_,e)=>{const p=g("app-btn-back"),C=g("app-select"),b=g("app-input"),D=g("app-btn");return k(),E(B,null,[c("div",W,[c("div",X,[c("div",Y,[c("div",z,[d(p,{onClick:e[0]||(e[0]=f=>a("back"))})]),e[7]||(e[7]=c("div",{class:"col-auto"},null,-1))])]),c("div",G,[d(x,{flat:"",class:"col full-height"},{default:h(()=>[d(U,{class:"full-height"},{default:h(()=>[d(Q,{class:"full-height q-pa-lg scroll"},{default:h(()=>{var f;return[c("div",J,[c("div",K,[d(C,{class:"col-12",modelValue:o(s).form.pelanggan,"onUpdate:modelValue":[e[1]||(e[1]=m=>o(s).form.pelanggan=m),e[2]||(e[2]=m=>S(m))],label:"Pilih Pelanggan",options:(f=o(r))==null?void 0:f.items,"option-label":"pelanggan","option-value":"pelanggan",disable:o(s).disableHeader},null,8,["modelValue","options","disable"]),d(b,{class:"col-6",modelValue:o(s).form.alamat,"onUpdate:modelValue":e[3]||(e[3]=m=>o(s).form.alamat=m),label:"Alamat",readonly:"",valid:{required:!0},disable:o(s).disableHeader},null,8,["modelValue","disable"]),d(b,{class:"col-6",modelValue:o(s).form.nohp,"onUpdate:modelValue":e[4]||(e[4]=m=>o(s).form.nohp=m),label:"No. HP",readonly:"",valid:{required:!0},disable:o(s).disableHeader},null,8,["modelValue","disable"]),c("div",Z,[d(N,{class:"q-mb-md"}),o(s).form.pelanggan?(k(),A(D,{key:0,loading:o(s).loading,type:"button",dense:!1,label:"Tambah Rincian",clickable:"",onClick:e[5]||(e[5]=m=>w())},null,8,["loading"])):H("",!0)])])])]}),_:1}),d(o(u),{modelValue:o(s).dialogrincis,"onUpdate:modelValue":e[6]||(e[6]=f=>o(s).dialogrincis=f),data:l.data},null,8,["modelValue","data"])]),_:1})]),_:1})])]),c("div",j,[d(o(n))])],64)}}},le=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{le as F,M as u};
