import{aW as C,ac as M,c as Q,aZ as U,a_ as $,o as B,W as g,a4 as F,Y as R,$ as m,f as i,Z as h,aX as Z,a6 as N,a2 as l,aT as W,aY as Y}from"./index-C65Hd5S6.js";import{Q as z}from"./QForm-DoygxfT4.js";import{n as D,u as E}from"./notifs-C5sbblO4.js";import{u as H}from"./list-CUTjb7pe.js";const K=C("form-master-produk-store",{state:()=>({form:{id:null,produk:null,kodeproduk:null,harga:null,kodekategori:null,kategori:null,kodesatuan:null,satuan:null,flag:null},loading:!1}),actions:{initReset(r){if(r)return new Promise(d=>{for(const c in this.form)this.form[c]=r[c];this.form.kodeproduk=r==null?void 0:r.kodeproduk,console.log(this.form),d()});for(const d in this.form)this.form[d]=null},async save(r){return this.loading=!0,new Promise((d,c)=>{M.post("/xy/master/produk/savedata",this.form).then(({data:t})=>{var e;console.log("saved",t),this.loading=!1;const u=H();r?u!=null&&u.items&&((e=t==null?void 0:t.result)!=null&&e.id)&&(u.items=u.items.map(a=>(a==null?void 0:a.id)===t.result.id?{...a,...t.result}:a)):u.items.unshift(t==null?void 0:t.result),D("Data berhasil disimpan"),this.initReset(null),d(t)}).catch(t=>{this.loading=!1,c(t)})})}}}),L={class:"fit column"},O={class:"col-auto"},T={class:"row items-center q-pa-lg"},X={class:"col-grow"},A={class:"col full-height q-px-lg q-pb-lg"},G={class:"row q-col-gutter-md justify-around"},I={class:"col-12"},eo={__name:"FormPage",props:{data:{type:Object,default:null}},emits:["back"],setup(r,{emit:d}){const c=d,t=E(),u=Q(()=>t.screen.lt.sm),e=K(),a=U(),f=$(),b=r;B(()=>{e.initReset(b.data)});function V(k){var p;const o=(p=a==null?void 0:a.items.find(n=>(n==null?void 0:n.satuan)===k))==null?void 0:p.kodesatuan;e.form.kodesatuan=o}function q(k){var p;const o=(p=f==null?void 0:f.items.find(n=>(n==null?void 0:n.kategori)===k))==null?void 0:p.kodekategori;e.form.kodekategori=o}function y(){e.save(b.data)}return(k,o)=>{const p=g("app-btn-back"),n=g("app-input"),v=g("app-select"),P=g("app-btn");return R(),F("div",L,[m("div",O,[m("div",T,[m("div",X,[i(p,{onClick:o[0]||(o[0]=_=>c("back"))})]),o[8]||(o[8]=m("div",{class:"col-auto"},null,-1))])]),m("div",A,[i(Y,{flat:"",class:"col full-height"},{default:h(()=>[i(z,{class:"full-height",onSubmit:y},{default:h(()=>[i(Z,{class:"full-height q-pa-lg scroll"},{default:h(()=>{var _,S;return[m("div",G,[m("div",{class:N([`col-${u.value?12:6}`,"row q-col-gutter-md"])},[i(n,{class:"col-12",modelValue:l(e).form.produk,"onUpdate:modelValue":o[1]||(o[1]=s=>l(e).form.produk=s),label:"Produk Layanan",valid:{required:!1}},null,8,["modelValue"]),i(v,{class:"col-6",modelValue:l(e).form.satuan,"onUpdate:modelValue":[o[2]||(o[2]=s=>l(e).form.satuan=s),o[3]||(o[3]=s=>V(s))],label:"Satuan Produk",options:(_=l(a))==null?void 0:_.items,"option-label":"satuan","option-value":"satuan"},null,8,["modelValue","options"]),i(v,{class:"col-6",modelValue:l(e).form.kategori,"onUpdate:modelValue":[o[4]||(o[4]=s=>l(e).form.kategori=s),o[5]||(o[5]=s=>q(s))],label:"Kategori Produk",options:(S=l(f))==null?void 0:S.items,"option-label":"kategori","option-value":"kategori"},null,8,["modelValue","options"]),i(n,{class:"col-12",modelValue:l(e).form.harga,"onUpdate:modelValue":[o[6]||(o[6]=s=>l(e).form.harga=s),o[7]||(o[7]=s=>{const w=s==null?void 0:s.replace(/^0+/,"");s>1&&(l(e).form.harga=w)})],label:"Harga Produk",valid:{number:!0}},null,8,["modelValue"]),m("div",I,[i(W,{class:"q-my-md"}),i(P,{loading:l(e).loading,type:"submit",dense:!1,label:"Simpan"},null,8,["loading"])])],2)])]}),_:1})]),_:1})]),_:1})])])}}};export{eo as default};
